<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva con Pago - Gregorio Style</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background: #0A0A0A;
            color: #F5F5F5;
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: #1A1A1A;
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid #D4AF37;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .step.active {
            display: block;
        }

        h1 {
            color: #D4AF37;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        h2 {
            color: #D4AF37;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #B0B0B0;
            font-weight: bold;
        }

        select, input {
            width: 100%;
            padding: 1rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #2A2A2A;
            color: #F5F5F5;
            font-size: 1rem;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #D4AF37;
        }

        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
            font-size: 1rem;
        }

        .btn-primary {
            background: #D4AF37;
            color: #0A0A0A;
        }

        .btn-secondary {
            background: #2A2A2A;
            color: #F5F5F5;
            border: 1px solid #444;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        .qr-container {
            text-align: center;
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
        }

        .qr-image {
            width: 220px;
            height: 220px;
            border: 2px solid #D4AF37;
            border-radius: 10px;
        }

        .payment-details {
            background: #2A2A2A;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #444;
        }

        .detail-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .price-highlight {
            color: #D4AF37;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .whatsapp-link {
            display: none;
            background: #25D366;
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            text-align: center;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .whatsapp-link:hover {
            background: #128C7E;
            transform: translateY(-2px);
        }

        .payment-instructions {
            background: #2A2A2A;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .instruction-step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .step-number {
            background: #D4AF37;
            color: #0A0A0A;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .bank-info {
            background: #2A2A2A;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            text-align: center;
            border: 1px solid #D4AF37;
        }

        .bank-name {
            color: #D4AF37;
            font-weight: bold;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .error-message {
            color: #ff6b6b;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1.5rem;
            }
            
            .qr-image {
                width: 200px;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- PASO 1: Formulario de Reserva -->
        <div class="step active" id="step1">
            <h1>üìÖ Hacer Reserva</h1>
            
            <div class="form-group">
                <label>üíá Servicio:</label>
                <select id="servicio" onchange="actualizarPrecio()">
                    <option value="">Selecciona un servicio</option>
                    <option value="Corte Cl√°sico" data-precio="40">Corte Cl√°sico - Bs 40</option>
                    <option value="Corte Premium" data-precio="50">Corte Premium - Bs 50</option>
                    <option value="Corte + Barba" data-precio="60">Corte + Barba - Bs 60</option>
                    <option value="Afeitado Cl√°sico" data-precio="25">Afeitado Cl√°sico - Bs 25</option>
                    <option value="Arreglo de Barba" data-precio="20">Arreglo de Barba - Bs 20</option>
                </select>
                <div class="error-message" id="errorServicio">Por favor selecciona un servicio</div>
            </div>

            <div class="form-group">
                <label>üë®‚Äçüíº Barbero Preferido:</label>
                <select id="barbero">
                    <option value="Gregorio">Gregorio</option>
                    <option value="Carlos">Carlos</option>
                    <option value="Roberto">Roberto</option>
                    <option value="Cualquiera" selected>Cualquier barbero disponible</option>
                </select>
            </div>

            <div class="form-group">
                <label>üìÖ Fecha:</label>
                <input type="date" id="fecha" min="">
                <div class="error-message" id="errorFecha">Por favor selecciona una fecha</div>
            </div>

            <div class="form-group">
                <label>‚è∞ Hora:</label>
                <select id="hora">
                    <option value="09:00">09:00 AM</option>
                    <option value="10:00">10:00 AM</option>
                    <option value="11:00">11:00 AM</option>
                    <option value="12:00">12:00 PM</option>
                    <option value="13:00">01:00 PM</option>
                    <option value="14:00">02:00 PM</option>
                    <option value="15:00">03:00 PM</option>
                    <option value="16:00">04:00 PM</option>
                    <option value="17:00">05:00 PM</option>
                </select>
            </div>

            <div class="form-group">
                <label>üë§ Nombre Completo:</label>
                <input type="text" id="nombre" placeholder="Tu nombre completo">
                <div class="error-message" id="errorNombre">Por favor ingresa tu nombre</div>
            </div>

            <div class="form-group">
                <label>üìû Tel√©fono WhatsApp:</label>
                <input type="tel" id="telefono" placeholder="Ej: 61234567">
                <div class="error-message" id="errorTelefono">Por favor ingresa tu n√∫mero de WhatsApp</div>
            </div>

            <button class="btn btn-primary" onclick="validarFormulario()">
                üí≥ PROCEDER AL PAGO CON QR
            </button>
        </div>

        <!-- PASO 2: Pago con QR -->
        <div class="step" id="step2">
            <h1>üí≥ PAGO CON QR</h1>
            <p style="text-align: center; color: #B0B0B0; margin-bottom: 1.5rem;">Paga primero para confirmar tu reserva</p>
            
            <div class="payment-details">
                <div class="detail-row">
                    <span>Servicio:</span>
                    <span id="detalleServicio">-</span>
                </div>
                <div class="detail-row">
                    <span>Barbero:</span>
                    <span id="detalleBarbero">-</span>
                </div>
                <div class="detail-row">
                    <span>Fecha y Hora:</span>
                    <span id="detalleFechaHora">-</span>
                </div>
                <div class="detail-row">
                    <span>Cliente:</span>
                    <span id="detalleCliente">-</span>
                </div>
                <div class="detail-row">
                    <span>Tel√©fono:</span>
                    <span id="detalleTelefono">-</span>
                </div>
                <div class="detail-row">
                    <span>Monto a Pagar:</span>
                    <span class="price-highlight" id="detalleMonto">Bs 0</span>
                </div>
            </div>

            <div class="bank-info">
                <p><span class="bank-name">BANCO BISA</span></p>
                <p>Cuenta: 1234567890</p>
                <p>Titular: GREGORIO STYLE BARBERSHOP</p>
            </div>

            <div class="qr-container">
                <img src="qr-gregorio-style.png" alt="QR de Pago" class="qr-image" id="qrImage">
                <p style="color: #666; margin-top: 1rem;">Escanea con tu app bancaria</p>
            </div>

            <div class="payment-instructions">
                <h3>üìù INSTRUCCIONES DE PAGO:</h3>
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div class="step-text">Abre tu app bancaria (BISA, BNB, etc.)</div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div class="step-text">Selecciona "Pagar con QR"</div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div class="step-text">Escanea el c√≥digo QR de arriba</div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">4</div>
                    <div class="step-text">Confirma el pago del monto exacto</div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">5</div>
                    <div class="step-text">Haz click en "‚úÖ YA PAGU√â" abajo</div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="marcarComoPagado()" id="btnPagoConfirmado">
                ‚úÖ YA PAGU√â - CONFIRMAR RESERVA
            </button>

            <button class="btn btn-secondary" onclick="volverAlFormulario()">
                ‚Ü©Ô∏è VOLVER A MODIFICAR
            </button>

            <a href="#" class="whatsapp-link" id="whatsappBtn">
                üì± ENVIAR COMPROBANTE POR WHATSAPP
            </a>
        </div>
    </div>

    <script>
        // Configuraci√≥n - CAMBIA ESTOS DATOS
        const CONFIG = {
            numeroWhatsApp: "59167233590", // ‚¨ÖÔ∏è TU N√öMERO REAL AQU√ç
            nombreNegocio: "Gregorio Style",
            direccion: "Ecuador y Pasaje del Maestro"
        };

        // Precios de servicios
        const precios = {
            "Corte Cl√°sico": 40,
            "Corte Premium": 50,
            "Corte + Barba": 60,
            "Afeitado Cl√°sico": 25,
            "Arreglo de Barba": 20
        };

        // Inicializar fecha m√≠nima (hoy)
        document.getElementById('fecha').min = new Date().toISOString().split('T')[0];

        function actualizarPrecio() {
            const servicioSelect = document.getElementById('servicio');
            const precioSpan = document.getElementById('detalleMonto');
            const servicio = servicioSelect.value;
            
            if (servicio && precios[servicio]) {
                precioSpan.textContent = `Bs ${precios[servicio]}`;
            }
        }

        function validarFormulario() {
            let valido = true;

            // Validar servicio
            const servicio = document.getElementById('servicio').value;
            if (!servicio) {
                document.getElementById('errorServicio').style.display = 'block';
                valido = false;
            } else {
                document.getElementById('errorServicio').style.display = 'none';
            }

            // Validar fecha
            const fecha = document.getElementById('fecha').value;
            if (!fecha) {
                document.getElementById('errorFecha').style.display = 'block';
                valido = false;
            } else {
                document.getElementById('errorFecha').style.display = 'none';
            }

            // Validar nombre
            const nombre = document.getElementById('nombre').value.trim();
            if (!nombre) {
                document.getElementById('errorNombre').style.display = 'block';
                valido = false;
            } else {
                document.getElementById('errorNombre').style.display = 'none';
            }

            // Validar tel√©fono
            const telefono = document.getElementById('telefono').value.trim();
            if (!telefono) {
                document.getElementById('errorTelefono').style.display = 'block';
                valido = false;
            } else {
                document.getElementById('errorTelefono').style.display = 'none';
            }

            if (valido) {
                irAPaso2();
            }
        }

        function irAPaso2() {
            // Obtener datos del formulario
            const servicio = document.getElementById('servicio').value;
            const barbero = document.getElementById('barbero').value;
            const fecha = document.getElementById('fecha').value;
            const hora = document.getElementById('hora').value;
            const nombre = document.getElementById('nombre').value.trim();
            const telefono = document.getElementById('telefono').value.trim();

            // Formatear fecha
            const fechaObj = new Date(fecha);
            const fechaFormateada = fechaObj.toLocaleDateString('es-ES', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });

            // Actualizar detalles en paso 2
            document.getElementById('detalleServicio').textContent = servicio;
            document.getElementById('detalleBarbero').textContent = barbero;
            document.getElementById('detalleFechaHora').textContent = `${fechaFormateada}, ${hora}`;
            document.getElementById('detalleCliente').textContent = nombre;
            document.getElementById('detalleTelefono').textContent = telefono;
            document.getElementById('detalleMonto').textContent = `Bs ${precios[servicio]}`;

            // Guardar datos en localStorage para usar despu√©s
            const reservaData = {
                servicio,
                barbero,
                fecha: fechaFormateada,
                hora,
                nombre,
                telefono,
                precio: precios[servicio],
                referencia: `GS${Date.now().toString().slice(-6)}`,
                timestamp: Date.now()
            };
            
            localStorage.setItem('reservaActual', JSON.stringify(reservaData));

            // Cambiar al paso 2
            document.getElementById('step1').classList.remove('active');
            document.getElementById('step2').classList.add('active');
        }

        function volverAlFormulario() {
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step1').classList.add('active');
        }

        function marcarComoPagado() {
            const reservaData = JSON.parse(localStorage.getItem('reservaActual'));
            
            if (!reservaData) {
                alert('Error: No se encontraron datos de la reserva');
                return;
            }

            // Marcar como pagado en localStorage
            reservaData.pagado = true;
            reservaData.fechaPago = new Date().toLocaleString();
            localStorage.setItem('reservaActual', JSON.stringify(reservaData));

            // Mostrar bot√≥n de WhatsApp
            document.getElementById('whatsappBtn').style.display = 'block';
            document.getElementById('btnPagoConfirmado').disabled = true;
            document.getElementById('btnPagoConfirmado').textContent = '‚úÖ PAGO CONFIRMADO';

            // Configurar WhatsApp
            configurarWhatsApp(reservaData);

            alert('‚úÖ Pago confirmado. Ahora env√≠a el comprobante por WhatsApp para finalizar tu reserva.');
        }

        function configurarWhatsApp(reservaData) {
            const mensaje = `‚úÖ *RESERVA CON PAGO CONFIRMADO* - ${CONFIG.nombreNegocio}

üíá *Servicio:* ${reservaData.servicio}
üë®‚Äçüíº *Barbero:* ${reservaData.barbero}
üìÖ *Fecha y Hora:* ${reservaData.fecha}, ${reservaData.hora}
üë§ *Cliente:* ${reservaData.nombre}
üìû *Tel√©fono:* ${reservaData.telefono}
üí∞ *Monto Pagado:* Bs ${reservaData.precio}
üìã *Referencia:* ${reservaData.reference}

üí≥ *M√©todo de Pago:* QR Bancario
üè¶ *Banco:* BANCO BISA
‚è∞ *Hora de Pago:* ${reservaData.fechaPago}

üéâ *¬°Reserva confirmada y asegurada!*

Te esperamos en ${CONFIG.nombreNegocio}
üìç ${CONFIG.direccion}
üìû ${CONFIG.numeroWhatsApp}`;

            const mensajeCodificado = encodeURIComponent(mensaje);
            const urlWhatsApp = `https://wa.me/${CONFIG.numeroWhatsApp}?text=${mensajeCodificado}`;
            
            document.getElementById('whatsappBtn').href = urlWhatsApp;
        }

        // Manejar error de imagen QR
        document.getElementById('qrImage').addEventListener('error', function() {
            this.alt = 'QR no disponible - Contactar al ' + CONFIG.numeroWhatsApp;
            this.style.backgroundColor = '#f8f8f8';
            this.style.display = 'flex';
            this.style.alignItems = 'center';
            this.style.justifyContent = 'center';
            this.style.fontSize = '0.8rem';
            this.style.color = '#333';
            this.style.padding = '1rem';
            this.style.textAlign = 'center';
            this.innerHTML = '‚ö†Ô∏è QR NO DISPONIBLE<br>Contactar al:<br><strong>' + CONFIG.numeroWhatsApp + '</strong>';
        });

        // Verificar si hay una reserva en proceso al cargar la p√°gina
        window.addEventListener('load', function() {
            const reservaActual = localStorage.getItem('reservaActual');
            if (reservaActual) {
                const data = JSON.parse(reservaActual);
                if (data.pagado) {
                    // Si ya estaba pagado, ir directamente al paso 2 con WhatsApp habilitado
                    irAPaso2();
                    document.getElementById('whatsappBtn').style.display = 'block';
                    document.getElementById('btnPagoConfirmado').disabled = true;
                    document.getElementById('btnPagoConfirmado').textContent = '‚úÖ PAGO CONFIRMADO';
                    configurarWhatsApp(data);
                }
            }
        });
    </script>
</body>
</html>